<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>다빈치 코드 게임</title>
<style>
    #gameArea {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
}

.playerArea {
    flex-basis: 100%; /* 기본적으로 한 플레이어는 전체 너비를 사용 */
    text-align: center;
    padding: 20px;
    box-sizing: border-box;
}

.tile {
    margin: 5px;
    padding: 10px;
    display: inline-block;
    color: white;
    font-weight: bold;
    text-align: center;
    width: 40px; /* 너비 설정 */
    height: 60px; /* 높이 설정 */
}

.blackTile {
    background-color: black;
}

.whiteTile {
    background-color: white;
    color: black; /* 백색 타일에는 검은색 글씨 */
}

.jokerTile {
    background-color: gold; /* 조커 타일 색상 */
    color: black; /* 텍스트 색상 */
}

.remainingTiles {
    text-align: center;
    margin-top: 20px;
}

/* 플레이어 수에 따른 화면 분할 */
.twoPlayers .playerArea { flex-basis: 50%; }
.threePlayers .playerArea { flex-basis: 33.3333%; }
.fourPlayers .playerArea { flex-basis: 25%; }

/* 각 플레이어 영역의 배경색 */
.playerArea:nth-child(1) { background-color: lightblue; }
.playerArea:nth-child(2) { background-color: lightgreen; }
.playerArea:nth-child(3) { background-color: lightcoral; }
.playerArea:nth-child(4) { background-color: lightgoldenrodyellow; }

</style>
<!-- <link rel="stylesheet" href="style.css"> -->
</head>
<body>
<div id="playerInput">
    <label for="playerCount">Player 수 (2-4명): </label>
    <input type="number" id="playerCount" min="2" max="4" value="2">
    <button onclick="setupPlayers()">확인</button>
</div>
<div id="gameArea"></div>

<script>
    // 타일 생성 및 섞기 함수 (조커 타일 없이 흑백 타일만 생성)
    function createAndShuffleTiles() {
        let tiles = [];
        for (let i = 0; i < 12; i++) {
            tiles.push(`흑색 ${i}`);
            tiles.push(`백색 ${i}`);
        }
        // 타일 섞기
        for (let i = tiles.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [tiles[i], tiles[j]] = [tiles[j], tiles[i]];
        }
        return tiles;
    }
    
    // 타일을 숫자와 색상에 따라 정렬하는 함수
    function sortTiles(tiles) {
        return tiles.sort((a, b) => {
            const [colorA, numberA] = a.split(' ');
            const [colorB, numberB] = b.split(' ');
            const numA = parseInt(numberA, 10);
            const numB = parseInt(numberB, 10);
            if (numA !== numB) return numA - numB; // 숫자 기준 정렬
            return colorA === '흑색' ? -1 : 1; // 숫자가 같을 경우 흑색이 먼저 오도록
        });
    }
    
    // 타일 분배 및 화면에 표시 함수 (조커 타일 포함하여 남은 타일 처리)
    function distributeTiles(playerCount) {
        let tiles = createAndShuffleTiles();
        const tilesPerPlayer = playerCount === '4' ? 3 : 4;
        const totalTilesNeeded = tilesPerPlayer * playerCount;
        const gameArea = document.getElementById('gameArea');
        gameArea.innerHTML = ''; // 이전 내용 초기화
    
        // 플레이어에게 타일 분배
        for (let i = 0; i < playerCount; i++) {
            let playerTiles = tiles.slice(i * tilesPerPlayer, (i + 1) * tilesPerPlayer);
            playerTiles = sortTiles(playerTiles); // 분배 받은 후 타일 정렬
            // const playerTiles = tiles.slice(i * tilesPerPlayer, (i + 1) * tilesPerPlayer);
            const playerDiv = document.createElement('div');
            playerDiv.classList.add('playerArea');
            playerDiv.innerHTML = `<h2>플레이어 ${i + 1}</h2>` +
                playerTiles.map(tile => tileToHtml(tile)).join('');
            gameArea.appendChild(playerDiv);
        }
    
        // 조커 타일 추가 및 남은 타일에 포함하여 섞기
        tiles = tiles.slice(totalTilesNeeded); // 미분배 타일
        tiles.push('조커', '조커'); // 조커 타일 추가
        // 남은 타일 섞기
        for (let i = tiles.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [tiles[i], tiles[j]] = [tiles[j], tiles[i]];
        }
    
        // 남은 타일 표시
        const remainingDiv = document.createElement('div');
        remainingDiv.classList.add('remainingTiles');
        remainingDiv.innerHTML = `<h2>남은 타일들</h2>` +
            tiles.map(tile => tileToHtml(tile)).join('');
        gameArea.appendChild(remainingDiv);
    }
    
    function tileToHtml(tile) {
        const [color, number] = tile.split(' ');
        const tileClass = color === '흑색' ? 'blackTile' : color === '백색' ? 'whiteTile' : 'jokerTile'; // 조커 타일 처리
        return `<div class="tile ${tileClass}">${number || ''}</div>`; // 조커는 숫자 없음
    }
    
    
    function setupPlayers() {
        const playerCount = document.getElementById('playerCount').value;
        const gameArea = document.getElementById('gameArea');
        gameArea.className = ''; // 이전 클래스 이름 초기화
    
        const playerClass = playerCount === '2' ? 'twoPlayers' : playerCount === '3' ? 'threePlayers' : 'fourPlayers';
        gameArea.classList.add(playerClass);
    
        distributeTiles(playerCount);
    }  
</script>
</body>
</html>